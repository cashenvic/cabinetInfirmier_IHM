<!--TODO: Revoir les patterns des inputs-->
<h1 mat-dialog-title>{{titreDialog}}</h1>
<div mat-dialog-content>
    <form (submit)="addPatient()" #formulaire="ngForm">
        
        <div>
            <mat-form-field appearance="outline">
                <mat-label>Nom</mat-label>
                <input matInput type="text" id="nom" name="nom" pattern="[A-Z]([a-z]*[üûùôïîëêèéçâà '-]*[A-Z]*){2,20}$"
                       [(ngModel)]="data.patient.nom" placeholder="Nom" required/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Prénom</mat-label>
                <input matInput type="text" id="prenom" name="prenom" pattern="[A-Z]([a-z]*[üûùôïîëêèéçâà '-]*[A-Z]*){2,20}$"
                       [(ngModel)]="data.patient.prenom" placeholder="Prénom" required/>
            </mat-form-field>
        </div>


        <!--Date de naissance-->
        <div>
            <mat-form-field>
                <input matInput id="naissance" name="naissance" [(ngModel)]="data.patient.naissance"
                       [max]="maxDate" [matDatepicker]="picker" placeholder="Date de naissance"/>
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
        </div>

        
        <div>
            <mat-form-field>
                <mat-select placeholder="Sexe" name="sexe" [(ngModel)]="data.patient.sexe" required>
                    <mat-option value="{{feminin}}">Feminin</mat-option>
                    <mat-option value="{{masculin}}">Masculin</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Numéro de sécurité sociale</mat-label>
                <input matInput type="text" id="secu" name="secu" placeholder="13 caractères"
                       [(ngModel)]="data.patient.numeroSecuriteSociale"
                       required pattern="[123478]\d\d(0[1-9]|1[012])([02][1-9]|(1|[3-9])[0-9]|2B|2A)(0\d[1-9]|[1-8]\d\d|9[0-8]\d|990)(0\d[1-9]|[1-9]\d\d)([0-8]\d|9[0-7])"/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Numéro</mat-label>
                <input matInput type="number" id="numero" name="numero"
                        placeholder="Numéro Facultatif"  pattern="[0-9]{1,5}"
                        [(ngModel)]="data.patient.adresse.numero"/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Rue</mat-label>
                <input matInput type="text" id="rue" placeholder="Rue" name="rue"
                        [(ngModel)]="data.patient.adresse.rue" pattern="([a-z]*[ÿüûùôïîëêèéçâàŸÜÛÙÔÏÎËÊÈÉÇÂÀ '-]*[A-Z]*){5,50}$" required/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Etage</mat-label>
                <!--https://fr.sputniknews.com/insolite/201512011019945249-arabie-saoudite-gratte-ciel-record/-->
                <!-- +1 juste au cas ou ;)-->
                <input matInput type="number" min="1" max="201" id="etage" name="etage"
                       placeholder="Etage Facultatif"
                       [(ngModel)]="data.patient.adresse.etage"/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Ville</mat-label>
                <input matInput type="text" id="ville" placeholder="Ville"
                       name="ville" pattern="([a-z]*[ÿüûùôïîëêèéçâàŸÜÛÙÔÏÎËÊÈÉÇÂÀ '-]*[A-Z]*){3,20}$"
                       [(ngModel)]="data.patient.adresse.ville" required/>
            </mat-form-field>
        </div>

        <div>
            <mat-form-field appearance="outline">
                <mat-label>Code postal</mat-label>
                <input matInput type="number" pattern="\d\d\d\d\d" id="codepostal"
                       placeholder="5 chifres"   name="codepostal"
                       [(ngModel)]="data.patient.adresse.codePostal" required/>
            </mat-form-field>
        </div>

        <!--
        - actes
        - intervenant
        - date de visite
        on peut ajouter l'ajout de ces 3 champs mais le serveur ne prends en compte ces champs
        -->

    </form>
</div>
<!-- cdkFocusInitial dirige le focus vers l'element-->
<div mat-dialog-actions fxLayoutAlign="center">
    <button mat-raised-button class="mr-3 w-25 annuler" (click)="onNoClick()" >Annuler</button>
    <button mat-raised-button class="enregist" [mat-dialog-close]="data.patient" cdkFocusInitial
            [disabled]="!formulaire.valid" class="w-25">
        Enregistrer
    </button>
</div>
